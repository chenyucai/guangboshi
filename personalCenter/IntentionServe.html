<!DOCTYPE html>
<html>

	<head>
		<title></title>

		<head>
			<meta charset="UTF-8">
			<meta id="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" name="viewport">
			<meta content="yes" name="apple-mobile-web-app-capable">
			<meta content="black" name="apple-mobile-web-app-status-bar-style">
			<title></title>
			<link href="../static/css/common.css" rel="stylesheet">
			<link href="../static/css/style.css" rel="stylesheet">
			<link href="../static/css/icon.css" rel="stylesheet">
			<link href="../css/xiala/main.css" rel="stylesheet">
			<link href="../css/xiala/normalize.css" rel="stylesheet">
			<script src="../static/js/jquery-1.9.1.js"></script>
			<script src="../static/js/idangerous.swiper.js"></script>
			<script src="../static/js/web.js"></script>
			<script src="../static/js/jquery.raty.js"></script>
			<script src="../js/common.js"></script>
			<script src="../js/location.js"></script>
			<script src="../js/jquery.tmpl.min.js"></script>
			<script src="../js/jquery.cookie.js "></script>

			<script type="text/html" id="ServeTemplate">
				{{each(i,name) IntentionServeList}}
					{{if name.IsSelected}}
					<a href="javascript:void(0)" class="btn btnSm style_4" id="${name.Id}">${name.Name}</a>
					{{else}}
					<a href="javascript:void(0)" class="btn btnSm style_4" id="${name.Id}" style="display:none">${name.Name}</a>
					{{/if}}
				{{/each}}
			</script>

			<script type="text/html" id="ServeListTemplate">
				{{each(i,name) IntentionServeList}}
					<a href="javascript:void(0)" class="btn btnSm style_4" data-selected="${name.IsSelected}" data-id="${name.Id}" >${name.Name}</a>
				{{/each}}
			</script>

			<style type="text/css">
				html,
				body {
					color: #222;
					font-family: Microsoft YaHei, Helvitica, Verdana, Tohoma, Arial, san-serif;
					margin: 0;
					padding: 0;
					text-decoration: none;
				}

				img {
					border: 0;
				}

				ul {
					list-style: none outside none;
					margin: 0;
					padding: 0;
				}

				body {
					background-color: #eee;
				}

				body .mainmenu:after {
					clear: both;
					content: " ";
					display: block;
				}

				body .mainmenu li {
					float: left;
					width: 33%;
					height: 100px;
					/*		border-radius: 3px;
*/
					overflow: hidden;
					border-top: 1px solid #B8B8B8;
					border-right: 1px solid #B8B8B8;
				}

				body .mainmenu li a {
					display: block;
					color: black;
					text-align: center
				}

				body .mainmenu li a b {
					display: block;
					height: 60px;
				}

				body .mainmenu li a img {
					margin: 15px auto 15px;
					width: 30px;
					height: 30px;
				}

				body .mainmenu li a span {
					display: block;
					height: 40px;
					line-height: 20px;
					color: #999;
					font-size: 14px;
				}

				.footNav ul li.active a {
					color: #F03B92;
				}
			</style>
		</head>

		<body>
			<div class="layoutMain" style="font:">
				<header class="pageHead clearfix">
					<div class="headLeft">
						<a href="javascript:history.go(-1)" class="headLeftBtn"><i class="icon-circle-cross"></i></a>
					</div>
					<h2 class="headTitle">
						意向服务
						<div class="headRight">
							<a href="javascript:void(0)" class="headRightBtn"><i class="icon-circle-check"></i></a>
						</div>
            		</h2>
				</header>
				<div class="pageMain noFoot">
					<div>
						已选服务
					</div>
					<div id="IntentionServe"></div>
					<div>
						光电美容
					</div>
					<div id="IntentionServeList"></div>
				</div>
			</div>
		</body>

</html>
<script>
	$.get(constants.baseUrl + "/AppPersonal/GetPersonaIntentionServe?UserId=" + $.cookie("userId"), function(response) {
		var IntentionServe = $("#IntentionServe");
		$('#ServeTemplate').tmpl(response).appendTo(IntentionServe);
		IntentionServe.find("a").each(
			function() {
				var RanColor = '#' + Math.floor(16777216 * Math.random()).toString(16);
				$(this).css('color',  RanColor)
				$(this).css('border', '1px solid ' + RanColor)
			}
		);

		var IntentionServeList = $("#IntentionServeList");
		$('#ServeListTemplate').tmpl(response).appendTo(IntentionServeList);
		IntentionServeList.find("a").each(
			function() {
				if($(this).attr("data-selected") == "true")
				{
					var RanColor = '#' + Math.floor(16777216 * Math.random()).toString(16);
					console.log(RanColor);
					if (RanColor == "#000000") {
						RanColor = "#85c4ba";
					}
					if (RanColor == "#ffffff" || RanColor == "#FFFFFF") {
						RanColor = "#dbf5f8";
					}
					if (RanColor.length != 7) {
						RanColor = "#dbf5f8";
					}
					$(this).css('color', '#000000')
					$(this).css('background-color',  RanColor)
					$(this).css('border', '1px solid ' + RanColor)
				}else{
					var RanColor = '#' + Math.floor(16777216 * Math.random()).toString(16);
					$(this).css('color',  RanColor)
					$(this).css('border', '1px solid ' + RanColor)
				}
			}
		);
	})

	$("#IntentionServeList a").live("click", function() {
		if($(this).attr("data-selected") == "true")
		{
			$(this).attr("data-selected", "false");
			$(this).css('color', $(this).css('border-color'))
			$(this).css('background-color', '#ffffff')
			$("#" + $(this).attr("data-id")).css("display","none");
		}else{
			$(this).attr("data-selected", "true");
			$(this).css('color', '#ffffff')
			$(this).css('background-color', $(this).css('border-color'))
			$("#" + $(this).attr("data-id")).css("display","");
		}
	});

	$(".headRightBtn").live("click", function() {
		var ServeIdArr = [];
		$("#IntentionServe a:visible").each(function(){
			ServeIdArr.push($(this).attr("id"));
		});
		$.post(constants.baseUrl + "/AppPersonal/SavePersonalDetail", {
			UserId: $.cookie("userId"),
			Name: "IntentionServe",
			Value: ServeIdArr.join(',')
		},
			function(data) {
				if(data != "") {alert(data)}
				else{
					location.href = "personalData.html"
				}
		})
	});
</script>
